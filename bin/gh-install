#!/usr/bin/env bash

# Require 2 args
if [[ $# -lt 2 ]]; then
  echo "Usage: $(basename $0) user/repo file-path [save-to-dir or ./] [branch or master]"
  exit 1
fi

REPOPATH=$1
FILEPATH=$2
FILENAME=$(basename ${FILEPATH})
SAVE_DIR=${3-$(pwd)}
BRANCH=${4-"master"}

GET_THIS="https://raw.githubusercontent.com/${REPOPATH}/${BRANCH}/${FILEPATH}"

if curl-report ${GET_THIS} -o ~/tmp/${FILENAME}; then
  chmod +x ~/tmp/${FILENAME} && mkdir -p ${SAVE_DIR}
  mv ~/tmp/${FILENAME} ${SAVE_DIR}/${FILENAME}
  echo "Located:"
  echo "$(ls -l ${SAVE_DIR}/${FILENAME})"
elif [ -f ~/tmp/${FILENAME} ]; then
  rm ~/tmp/${FILENAME}
fi
